"use strict";(globalThis.webpackChunkros2_book=globalThis.webpackChunkros2_book||[]).push([[47],{1953(e,n,t){t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>r});const o=JSON.parse('{"id":"module1/solutions/exercise4_solution","title":"Exercise 4 Solution: Create an action client","description":"Problem Statement","source":"@site/docs/module1/solutions/exercise4_solution.md","sourceDirName":"module1/solutions","slug":"/module1/solutions/exercise4_solution","permalink":"/docs/module1/solutions/exercise4_solution","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module1/solutions/exercise4_solution.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Exercise 3 Solution: Create a parameterized node","permalink":"/docs/module1/solutions/exercise3_solution"},"next":{"title":"Exercise 5 Solution: Modify the simple humanoid model to add an extra joint","permalink":"/docs/module1/solutions/exercise5_solution"}}');var l=t(4848),i=t(8453);const s={},c="Exercise 4 Solution: Create an action client",a={},r=[{value:"Problem Statement",id:"problem-statement",level:2},{value:"Expected Outcome",id:"expected-outcome",level:2},{value:"Solution",id:"solution",level:2},{value:"Running the Solution",id:"running-the-solution",level:2},{value:"Key Points",id:"key-points",level:2},{value:"Expected Output",id:"expected-output",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"exercise-4-solution-create-an-action-client",children:"Exercise 4 Solution: Create an action client"})}),"\n",(0,l.jsx)(n.h2,{id:"problem-statement",children:"Problem Statement"}),"\n",(0,l.jsx)(n.p,{children:"Create an action client that sends goals to an action server."}),"\n",(0,l.jsx)(n.h2,{id:"expected-outcome",children:"Expected Outcome"}),"\n",(0,l.jsx)(n.p,{children:"A ROS 2 action client that sends Fibonacci calculation goals and handles feedback and results."}),"\n",(0,l.jsx)(n.h2,{id:"solution",children:"Solution"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n# exercise4_solution.py\n\nimport rclpy\nfrom rclpy.action import ActionClient\nfrom rclpy.node import Node\nfrom example_interfaces.action import Fibonacci\n\n\nclass FibonacciClient(Node):\n    def __init__(self):\n        super().__init__('fibonacci_client')\n        self._action_client = ActionClient(self, Fibonacci, 'fibonacci')\n\n    def send_goal(self, order):\n        goal_msg = Fibonacci.Goal()\n        goal_msg.order = order\n\n        self.get_logger().info(f'Waiting for action server...')\n        self._action_client.wait_for_server()\n\n        self.get_logger().info(f'Sending goal: {order}')\n        future = self._action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.feedback_callback)\n\n        future.add_done_callback(self.goal_response_callback)\n\n    def goal_response_callback(self, future):\n        goal_handle = future.result()\n        if not goal_handle.accepted:\n            self.get_logger().info('Goal rejected')\n            return\n\n        self.get_logger().info('Goal accepted')\n        self._get_result_future = goal_handle.get_result_async()\n        self._get_result_future.add_done_callback(self.get_result_callback)\n\n    def feedback_callback(self, feedback):\n        self.get_logger().info(f'Received feedback: {feedback.feedback.sequence}')\n\n    def get_result_callback(self, future):\n        result = future.result().result\n        self.get_logger().info(f'Result: {result.sequence}')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    action_client = FibonacciClient()\n\n    action_client.send_goal(10)\n\n    try:\n        rclpy.spin(action_client)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        action_client.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,l.jsx)(n.h2,{id:"running-the-solution",children:"Running the Solution"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Save as ",(0,l.jsx)(n.code,{children:"exercise4_solution.py"})]}),"\n",(0,l.jsxs)(n.li,{children:["Make executable: ",(0,l.jsx)(n.code,{children:"chmod +x exercise4_solution.py"})]}),"\n",(0,l.jsx)(n.li,{children:"First run an action server (like the provided action_server.py)"}),"\n",(0,l.jsxs)(n.li,{children:["Then run the client: ",(0,l.jsx)(n.code,{children:"python3 exercise4_solution.py"})]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"key-points",children:"Key Points"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Action clients are created with ",(0,l.jsx)(n.code,{children:"ActionClient(node, action_type, action_name)"})]}),"\n",(0,l.jsxs)(n.li,{children:["Goals are sent asynchronously with ",(0,l.jsx)(n.code,{children:"send_goal_async()"})]}),"\n",(0,l.jsx)(n.li,{children:"Feedback is handled with a callback function"}),"\n",(0,l.jsx)(n.li,{children:"Results are handled when the goal completes"}),"\n",(0,l.jsx)(n.li,{children:"The client must wait for the server before sending goals"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"expected-output",children:"Expected Output"}),"\n",(0,l.jsx)(n.p,{children:"The client will send a goal to calculate Fibonacci sequence, receive feedback during processing, and display the final result."})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>s,x:()=>c});var o=t(6540);const l={},i=o.createContext(l);function s(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);